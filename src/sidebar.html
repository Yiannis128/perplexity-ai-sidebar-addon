<!DOCTYPE html>
<html lang="en" class="h-full">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Perplexity AI Chat</title>
  <link href="tailwind.css" rel="stylesheet" type="text/css" />
</head>

<body class="flex flex-col min-h-full">
  <!-- Header Navbar -->
  <nav class="navbar bg-base-200 border-b border-base-300 flex-shrink-0">
    <div class="navbar-start">
      <a class="text-lg font-medium btn btn-ghost" href="https://perplexity.ai">âœ¨ Perplexity
        AI</a>
    </div>
    <div class="navbar-end gap-2">
      <!-- API Key Button -->
      <button id="api-key-btn" class="btn btn-ghost btn-sm" title="Configure API Key">
        ğŸ”‘
      </button>

      <!-- Clear Chat Button -->
      <button id="clear-chat-btn" class="btn btn-ghost btn-sm" title="Clear Chat">ğŸ—‘ï¸</button>
    </div>
  </nav>

  <!-- Main Content Area - This is the key fix for full height -->
  <main class="flex-1 flex flex-col min-h-0 overflow-hidden">
    <!-- Chat Messages Container - This will now stretch to fill available space -->
    <div id="chat-container" class="flex-1 overflow-y-auto p-4 space-y-4">
      <!-- Welcome Message -->
      <div class="chat chat-start">
        <div class="chat-image avatar">
          <div class="w-8 rounded-full bg-primary text-primary-content flex items-center justify-center text-lg">
            ğŸ¤–
          </div>
        </div>
        <div class="chat-bubble chat-bubble-primary">
          Welcome! I'm your AI assistant powered by
          <a href="https://perplexity.ai" target="_blank">Perplexity AI</a>. I
          can help you understand and analyze the current webpage content.
          Start by configuring your API key using the ğŸ”‘ button above.
        </div>
      </div>
    </div>

    <!-- Input Area - Fixed at bottom -->
    <div class="border-t border-base-300 p-4 bg-base-100 flex-shrink-0">
      <div class="flex gap-2">
        <input type="text" id="message-input" placeholder="Ask me about this webpage..."
          class="input input-bordered flex-1" disabled />
        <button id="send-btn" class="btn btn-primary" disabled>
          <svg class="w-4 h-4" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 19l9 2-9-18-9 18 9-2zm0 0v-8">
            </path>
          </svg>
        </button>
      </div>
    </div>
  </main>

  <!-- API Key Modal -->
  <dialog id="api-key-modal" class="modal">
    <div class="modal-box">
      <form method="dialog">
        <button class="btn btn-sm btn-circle btn-ghost absolute right-2 top-2">âœ•</button>
      </form>

      <h3 class="font-bold text-lg mb-4">Configure Perplexity API Key</h3>

      <div class="space-y-4">
        <div>
          <label class="label">
            <span class="label-text">API Key</span>
            <span class="label-text-alt">
              <a href="https://www.perplexity.ai/settings/api" target="_blank" class="link link-primary text-xs">
                Get API Key
              </a>
            </span>
          </label>
          <input type="password" id="api-key-input" placeholder="pplx-..." class="input input-bordered w-full" />
        </div>

        <div id="api-key-status" class="text-sm hidden"></div>
      </div>

      <div class="modal-action">
        <button id="test-api-key-btn" class="btn btn-secondary">Test Connection</button>
        <button id="save-api-key-btn" class="btn btn-primary">Save</button>
      </div>
    </div>
  </dialog>

  <!-- Loading Overlay -->
  <div id="loading-overlay" class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden">
    <div class="bg-base-100 p-6 rounded-lg shadow-lg flex items-center gap-3">
      <span class="loading loading-spinner loading-md"></span>
      <span>Processing your message...</span>
    </div>
  </div>

  <script src="sidebar.js"></script>
</body>

</html>